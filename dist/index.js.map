{"version":3,"file":"index.js","sources":["../src/useObserve.ts","../src/Observe.tsx"],"sourcesContent":["import React from \"react\";\r\nimport { IProps } from \"./types\";\r\n\r\nfunction useObserve(useObserveOptions: IProps) {\r\n  const {\r\n    isIntersecting = () => {},\r\n    isNotIntersecting = () => {},\r\n    onEndObserving = () => {},\r\n    options,\r\n    triggersOnce = false,\r\n    unobserve = () => false,\r\n  } = useObserveOptions;\r\n\r\n  /**\r\n   * Reference which will contain element to observe\r\n   */\r\n  const elementRef = React.useRef<HTMLDivElement>(null);\r\n\r\n  /**\r\n   * Callback to listen for changes in element intersection state\r\n   * @param entries\r\n   * @param observer\r\n   */\r\n  function onIntersectionObserverEvent(\r\n    entries: IntersectionObserverEntry[],\r\n    observer: IntersectionObserver,\r\n  ) {\r\n    const [entry] = entries;\r\n\r\n    if (entry.isIntersecting) {\r\n      isIntersecting(entry);\r\n      // Give a truthy triggersOnce we disconnect observer after first isIntersecting call\r\n      if (triggersOnce) {\r\n        onEndObserving(entry);\r\n        observer.disconnect();\r\n      }\r\n    } else {\r\n      isNotIntersecting(entry);\r\n    }\r\n    // If unobserve function returns true we disconnect observer\r\n    if (unobserve(entry)) {\r\n      onEndObserving(entry);\r\n      observer.disconnect();\r\n    }\r\n  }\r\n\r\n  React.useEffect(() => {\r\n    const observer: IntersectionObserver = new IntersectionObserver(\r\n      onIntersectionObserverEvent,\r\n      options,\r\n    );\r\n\r\n    if (elementRef.current) {\r\n      observer.observe(elementRef.current);\r\n    }\r\n    /**\r\n     * Disconnect observer as soon as component unmount\r\n     */\r\n    return () => {\r\n      observer.disconnect();\r\n    };\r\n  }, [elementRef.current]);\r\n\r\n  return { elementRef };\r\n}\r\n\r\nexport { useObserve };\r\n","import React from \"react\";\r\nimport { IProps } from \"./types\";\r\nimport { useObserve } from \"./useObserve\";\r\n\r\nfunction cleanObserveProps(observeProps: IProps): object {\r\n  const propsClone: IProps = { ...observeProps };\r\n\r\n  delete propsClone.isIntersecting;\r\n  delete propsClone.isNotIntersecting;\r\n  delete propsClone.options;\r\n  delete propsClone.triggersOnce;\r\n  delete propsClone.unobserve;\r\n  delete propsClone.onEndObserving;\r\n  delete propsClone.as;\r\n\r\n  return propsClone;\r\n}\r\n\r\n/**\r\n * Component which will abstract intersection observer behaviour\r\n * @param props\r\n */\r\nconst Observe: React.FC<IProps> = (props) => {\r\n  const { as: Component = \"div\", children, ...restProps } = props;\r\n\r\n  const cleanedObserverProps = cleanObserveProps(restProps);\r\n  const { elementRef } = useObserve(props);\r\n\r\n  return (\r\n    <Component ref={elementRef} {...cleanedObserverProps}>\r\n      {children}\r\n    </Component>\r\n  );\r\n};\r\n\r\nexport { Observe };\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,SAAS,UAAU,CAAC,iBAAyB;IAEzC,IAAA,qCAAyB,EAAzB,qDAAyB,EACzB,wCAA4B,EAA5B,wDAA4B,EAC5B,qCAAyB,EAAzB,qDAAyB,EACzB,mCAAO,EACP,mCAAoB,EAApB,yCAAoB,EACpB,gCAAuB,EAAvB,8DAAuB,CACH;;;;IAKtB,IAAM,UAAU,GAAG,KAAK,CAAC,MAAM,CAAiB,IAAI,CAAC,CAAC;;;;;;IAOtD,SAAS,2BAA2B,CAClC,OAAoC,EACpC,QAA8B;QAEvB,IAAA,kBAAK,CAAY;QAExB,IAAI,KAAK,CAAC,cAAc,EAAE;YACxB,cAAc,CAAC,KAAK,CAAC,CAAC;;YAEtB,IAAI,YAAY,EAAE;gBAChB,cAAc,CAAC,KAAK,CAAC,CAAC;gBACtB,QAAQ,CAAC,UAAU,EAAE,CAAC;aACvB;SACF;aAAM;YACL,iBAAiB,CAAC,KAAK,CAAC,CAAC;SAC1B;;QAED,IAAI,SAAS,CAAC,KAAK,CAAC,EAAE;YACpB,cAAc,CAAC,KAAK,CAAC,CAAC;YACtB,QAAQ,CAAC,UAAU,EAAE,CAAC;SACvB;KACF;IAED,KAAK,CAAC,SAAS,CAAC;QACd,IAAM,QAAQ,GAAyB,IAAI,oBAAoB,CAC7D,2BAA2B,EAC3B,OAAO,CACR,CAAC;QAEF,IAAI,UAAU,CAAC,OAAO,EAAE;YACtB,QAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;SACtC;;;;QAID,OAAO;YACL,QAAQ,CAAC,UAAU,EAAE,CAAC;SACvB,CAAC;KACH,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC;IAEzB,OAAO,EAAE,UAAU,YAAA,EAAE,CAAC;AACxB,CAAC;;;AC5DD,SAAS,iBAAiB,CAAC,YAAoB;IAC7C,IAAM,UAAU,gBAAgB,YAAY,CAAE,CAAC;IAE/C,OAAO,UAAU,CAAC,cAAc,CAAC;IACjC,OAAO,UAAU,CAAC,iBAAiB,CAAC;IACpC,OAAO,UAAU,CAAC,OAAO,CAAC;IAC1B,OAAO,UAAU,CAAC,YAAY,CAAC;IAC/B,OAAO,UAAU,CAAC,SAAS,CAAC;IAC5B,OAAO,UAAU,CAAC,cAAc,CAAC;IACjC,OAAO,UAAU,CAAC,EAAE,CAAC;IAErB,OAAO,UAAU,CAAC;AACpB,CAAC;AAED;;;;AAIA,IAAM,OAAO,GAAqB,UAAC,KAAK;IAC9B,IAAA,aAAqB,EAArB,sCAAqB,EAAE,yBAAQ,EAAE,6CAAY,CAAW;IAEhE,IAAM,oBAAoB,GAAG,iBAAiB,CAAC,SAAS,CAAC,CAAC;IAClD,IAAA,yCAAU,CAAuB;IAEzC,QACE,oBAAC,SAAS,aAAC,GAAG,EAAE,UAAU,IAAM,oBAAoB,GACjD,QAAQ,CACC,EACZ;AACJ,CAAC,CAAC;AAEF;;;;"}